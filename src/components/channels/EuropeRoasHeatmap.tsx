
import React, { useMemo, useState } from "react";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Skeleton } from "@/components/ui/skeleton";
import { Info, Map } from "lucide-react";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";

// Define European regions and their mock ROAS data
const europeRegionsData = [
  { id: "uk", name: "United Kingdom", roas: 4.2, code: "GB" },
  { id: "fr", name: "France", roas: 3.7, code: "FR" },
  { id: "de", name: "Germany", roas: 4.5, code: "DE" },
  { id: "es", name: "Spain", roas: 3.2, code: "ES" },
  { id: "it", name: "Italy", roas: 3.8, code: "IT" },
  { id: "nl", name: "Netherlands", roas: 5.1, code: "NL" },
  { id: "be", name: "Belgium", roas: 4.3, code: "BE" },
  { id: "pt", name: "Portugal", roas: 2.9, code: "PT" },
  { id: "ch", name: "Switzerland", roas: 5.3, code: "CH" },
  { id: "at", name: "Austria", roas: 4.1, code: "AT" },
  { id: "se", name: "Sweden", roas: 4.8, code: "SE" },
  { id: "no", name: "Norway", roas: 4.6, code: "NO" },
  { id: "dk", name: "Denmark", roas: 4.4, code: "DK" },
  { id: "fi", name: "Finland", roas: 3.9, code: "FI" },
  { id: "pl", name: "Poland", roas: 3.1, code: "PL" },
  { id: "cz", name: "Czech Republic", roas: 3.0, code: "CZ" },
  { id: "hu", name: "Hungary", roas: 2.8, code: "HU" },
  { id: "ro", name: "Romania", roas: 2.6, code: "RO" },
  { id: "gr", name: "Greece", roas: 2.7, code: "GR" },
  { id: "ie", name: "Ireland", roas: 4.0, code: "IE" },
];

// Country path data for a simplified Europe map
const europeMapPaths = {
  GB: "M 411.66,155.44 L 409.93,159.64 L 411.4,164.99 L 415.39,165.05 L 415.08,167.79 L 412.79,168.2 L 412.07,171.54 L 409.91,174.39 L 407.15,180.18 L 407.04,184.61 L 403.94,188.73 L 399.83,188.77 L 394.11,192.5 L 389.95,198.76 L 385.5,202 L 380.96,201.37 L 378.92,195.36 L 380.38,189.31 L 385.08,183.44 L 384.84,179.05 L 379.94,178 L 376.56,175.65 L 371.85,176.47 L 368.15,173.1 L 367.29,166.86 L 372.54,165.91 L 378.88,159.15 L 376.66,156.72 L 376.85,152.6 L 381.17,147.56 L 383.36,139 L 385.88,137.89 L 390.91,140.4 L 397.56,141.28 L 401.96,138.88 L 407.23,144.41 L 411.66,155.44 Z",
  FR: "M 449.92,206.92 L 446.27,213.19 L 439.16,214.71 L 434.99,212.25 L 429.92,212.68 L 427.76,209.34 L 424.15,209.3 L 420.95,205.01 L 418.07,206.27 L 415.77,203.44 L 414.51,196.83 L 410.12,192.76 L 411.03,188.06 L 406.93,186.58 L 404.34,183.11 L 399.5,182.98 L 397.6,178.31 L 394.03,177.98 L 391.72,179.7 L 387.4,178.77 L 386.12,180.91 L 382.41,180.4 L 380.96,183.29 L 376.23,185.78 L 376.56,175.65 L 371.85,176.47 L 368.15,173.1 L 367.29,166.86 L 372.54,165.91 L 378.88,159.15 L 376.66,156.72 L 376.85,152.6 L 381.17,147.56 L 383.36,139 L 391.5,139 L 396.37,134.22 L 401.5,134.22 L 401.64,139.88 L 410.5,141.51 L 410.99,149.91 L 419.9,149.8 L 422.46,147.52 L 424.66,150.06 L 429.33,150.29 L 431.29,147.98 L 436.78,149.93 L 439.28,153.23 L 441.46,153.1 L 446.78,158.61 L 449.69,157.01 L 452.42,151.84 L 458.17,152.7 L 458.88,156.24 L 463.73,156.8 L 465.9,159.2 L 464.98,163.95 L 459.96,169.64 L 460.22,173.3 L 457.57,177.02 L 453.63,179.02 L 449.92,184.25 L 450.81,194.26 L 449.92,206.92 Z",
  DE: "M 449.92,206.92 L 450.05,214.36 L 453.67,215.58 L 453.95,219.22 L 457.21,221.67 L 456.28,225.64 L 459.11,229.21 L 463.34,226.98 L 466.59,229.85 L 467.96,234.54 L 470.39,235.77 L 474.9,234.39 L 477.74,235.46 L 481.28,233.86 L 484.92,236.38 L 487.75,234.29 L 490.95,235.07 L 493.1,233.71 L 492.61,228.39 L 490.37,226.24 L 490.25,223.3 L 492.5,223.3 L 493.74,220.34 L 492.93,213.66 L 496.5,212.94 L 498.08,210.13 L 502.86,208.51 L 504.76,210.05 L 510.15,208.08 L 511.31,205.92 L 510.2,200.78 L 507.76,198.51 L 508.92,195.35 L 514.28,193.9 L 514.9,190.84 L 518.91,189.83 L 520.31,187.51 L 518.68,185.3 L 521.61,183.45 L 523.28,180.11 L 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 507.78,171.02 L 504.79,166.47 L 501.72,167.08 L 498.91,165.96 L 495.52,167.3 L 489.58,165.9 L 487.75,163.67 L 484.71,163.78 L 484.33,156.71 L 481.36,156.44 L 472.33,152.55 L 469.33,153.94 L 467.01,153.3 L 465.82,156.26 L 463.73,156.8 L 458.88,156.24 L 458.17,152.7 L 452.42,151.84 L 449.69,157.01 L 446.78,158.61 L 441.46,153.1 L 439.28,153.23 L 436.78,149.93 L 431.29,147.98 L 429.33,150.29 L 424.66,150.06 L 422.46,147.52 L 419.9,149.8 L 410.99,149.91 L 410.5,141.51 L 401.64,139.88 L 403.49,135.94 L 407.5,135.94 L 409.21,134.49 L 413.92,134.49 L 417.54,137.25 L 417.76,126.29 L 421.96,126.29 L 424.38,128.72 L 429.67,128.68 L 431.45,125.78 L 433.88,126.64 L 433.79,129.96 L 437.43,129.76 L 438.62,133.8 L 441.3,134.79 L 441.42,130.62 L 443.79,130.62 L 444.3,133.03 L 447.17,134.76 L 450.82,131.62 L 450.68,127.85 L 453.34,125.48 L 457.56,124.92 L 458.94,126.83 L 463.25,127.31 L 463.86,125.91 L 466.36,126.94 L 470.9,126 L 473.64,127.51 L 477.78,125.2 L 480.5,127.23 L 482.12,125.66 L 485.92,127.66 L 487.22,123.41 L 490.43,123.16 L 491.44,129.48 L 494.4,130.05 L 494.84,133.32 L 498.29,133.33 L 499.68,135.08 L 497.15,140.03 L 493.22,143.08 L 493.22,146.71 L 490.26,149.95 L 489.79,153.1 L 492.6,153.99 L 498.09,153.38 L 498.36,155.97 L 501.28,157.78 L 502.1,161.77 L 500.22,164.6 L 505.01,169.45 L 504.54,172.78 L 501.27,173.14 L 498.58,177.28 L 494.84,177.93 L 489.57,182.9 L 484.3,189.16 L 478.66,191.89 L 478.33,195.51 L 476.61,196.84 L 475.5,200.19 L 472.21,201.17 L 469.49,205.01 L 465.42,204.97 L 461.8,204.07 L 458.62,206.81 L 454.81,205.99 L 449.92,206.92 Z",
  IT: "M 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 476.61,196.84 L 478.33,195.51 L 478.66,191.89 L 484.3,189.16 L 489.57,182.9 L 494.84,177.93 L 498.58,177.28 L 501.27,173.14 L 504.54,172.78 L 505.01,169.45 L 507.78,171.02 L 511.32,170.82 L 513.39,173.92 L 516.14,173.88 L 516.84,177.62 L 519.85,179.01 L 522.15,178.05 L 523.28,180.11 L 521.61,183.45 L 518.68,185.3 L 520.31,187.51 L 518.91,189.83 L 514.9,190.84 L 514.28,193.9 L 508.92,195.35 L 507.76,198.51 L 510.2,200.78 L 511.31,205.92 L 510.15,208.08 L 504.76,210.05 L 502.86,208.51 L 498.08,210.13 L 496.5,212.94 L 492.93,213.66 L 493.74,220.34 L 492.5,223.3 L 490.25,223.3 L 490.37,226.24 L 492.61,228.39 L 493.1,233.71 L 490.95,235.07 L 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 Z",
  ES: "M 415.77,203.44 L 418.07,206.27 L 420.95,205.01 L 424.15,209.3 L 427.76,209.34 L 429.92,212.68 L 434.99,212.25 L 439.16,214.71 L 446.27,213.19 L 449.92,206.92 L 450.81,194.26 L 449.92,184.25 L 453.63,179.02 L 457.57,177.02 L 460.22,173.3 L 459.96,169.64 L 464.98,163.95 L 465.9,159.2 L 463.73,156.8 L 465.82,156.26 L 467.01,153.3 L 469.33,153.94 L 472.33,152.55 L 481.36,156.44 L 484.33,156.71 L 484.71,163.78 L 487.75,163.67 L 489.58,165.9 L 495.52,167.3 L 498.91,165.96 L 501.72,167.08 L 504.79,166.47 L 507.78,171.02 L 505.01,169.45 L 500.22,164.6 L 502.1,161.77 L 501.28,157.78 L 498.36,155.97 L 498.09,153.38 L 492.6,153.99 L 489.79,153.1 L 490.26,149.95 L 493.22,146.71 L 493.22,143.08 L 497.15,140.03 L 499.68,135.08 L 498.29,133.33 L 494.84,133.32 L 494.4,130.05 L 491.44,129.48 L 490.43,123.16 L 487.22,123.41 L 485.92,127.66 L 482.12,125.66 L 480.5,127.23 L 477.78,125.2 L 473.64,127.51 L 470.9,126 L 466.36,126.94 L 463.86,125.91 L 463.25,127.31 L 458.94,126.83 L 457.56,124.92 L 453.34,125.48 L 450.68,127.85 L 450.82,131.62 L 447.17,134.76 L 444.3,133.03 L 443.79,130.62 L 441.42,130.62 L 441.3,134.79 L 438.62,133.8 L 437.43,129.76 L 433.79,129.96 L 433.88,126.64 L 431.45,125.78 L 429.67,128.68 L 424.38,128.72 L 421.96,126.29 L 417.76,126.29 L 417.54,137.25 L 413.92,134.49 L 409.21,134.49 L 407.5,135.94 L 403.49,135.94 L 401.64,139.88 L 401.5,134.22 L 396.37,134.22 L 391.5,139 L 383.36,139 L 385.88,137.89 L 390.91,140.4 L 397.56,141.28 L 401.96,138.88 L 407.23,144.41 L 411.66,155.44 L 409.93,159.64 L 411.4,164.99 L 415.39,165.05 L 415.08,167.79 L 412.79,168.2 L 412.07,171.54 L 409.91,174.39 L 407.15,180.18 L 407.04,184.61 L 403.94,188.73 L 399.83,188.77 L 394.11,192.5 L 389.95,198.76 L 385.5,202 L 380.96,201.37 L 378.92,195.36 L 380.38,189.31 L 385.08,183.44 L 384.84,179.05 L 379.94,178 L 376.23,185.78 L 371.16,190.53 L 367.5,190.76 L 366.36,192.88 L 359.42,198.16 L 357.34,197.27 L 354.11,203.05 L 350.57,201.62 L 347.17,203.94 L 344.11,203.55 L 341.2,207.53 L 338.53,208.31 L 336.36,211.79 L 333.16,211.79 L 331.07,210.28 L 330.96,207.01 L 329.35,204.52 L 327.66,206.63 L 322.95,209.54 L 318.82,211.77 L 314.92,210.35 L 312.93,207.43 L 314.42,205.56 L 315.12,203.33 L 312.59,201.37 L 308.73,197.74 L 311.47,195.6 L 311.47,193.15 L 314.75,192.01 L 315.97,189.46 L 318.6,189.86 L 320.55,187.39 L 321.16,183.79 L 324.3,181.5 L 324.41,178.57 L 326.76,173.81 L 331.55,173.12 L 332.95,174.31 L 334.48,174.31 L 334.93,167.35 L 338.24,163.55 L 341.12,163.71 L 342.67,165.12 L 347.31,164.54 L 347.82,164.99 L 350.74,162.94 L 353.88,164.48 L 358.26,163.6 L 361.47,164.85 L 363.86,164.06 L 365.35,165.55 L 369.52,165.62 L 370.42,163.67 L 373.32,163.55 L 376.85,152.6 L 376.66,156.72 L 378.88,159.15 L 372.54,165.91 L 367.29,166.86 L 368.15,173.1 L 371.85,176.47 L 376.56,175.65 L 380.96,183.29 L 382.41,180.4 L 386.12,180.91 L 387.4,178.77 L 391.72,179.7 L 394.03,177.98 L 397.6,178.31 L 399.5,182.98 L 404.34,183.11 L 406.93,186.58 L 411.03,188.06 L 410.12,192.76 L 414.51,196.83 L 415.77,203.44 Z",
  PT: "M 373.32,163.55 L 370.42,163.67 L 369.52,165.62 L 365.35,165.55 L 363.86,164.06 L 361.47,164.85 L 358.26,163.6 L 353.88,164.48 L 350.74,162.94 L 347.82,164.99 L 347.31,164.54 L 342.67,165.12 L 341.12,163.71 L 338.24,163.55 L 334.93,167.35 L 334.48,174.31 L 332.95,174.31 L 331.55,173.12 L 326.76,173.81 L 324.41,178.57 L 324.3,181.5 L 321.16,183.79 L 320.55,187.39 L 318.6,189.86 L 315.97,189.46 L 314.75,192.01 L 311.47,193.15 L 311.47,195.6 L 308.73,197.74 L 312.59,201.37 L 315.12,203.33 L 314.42,205.56 L 312.93,207.43 L 314.92,210.35 L 318.82,211.77 L 322.95,209.54 L 327.66,206.63 L 329.35,204.52 L 330.96,207.01 L 331.07,210.28 L 333.16,211.79 L 336.36,211.79 L 338.53,208.31 L 341.2,207.53 L 344.11,203.55 L 347.17,203.94 L 350.57,201.62 L 354.11,203.05 L 357.34,197.27 L 359.42,198.16 L 366.36,192.88 L 367.5,190.76 L 371.16,190.53 L 376.23,185.78 L 380.96,183.29 L 376.56,175.65 L 371.85,176.47 L 368.15,173.1 L 367.29,166.86 L 372.54,165.91 L 373.32,163.55 Z",
  NL: "M 481.96,156.47 L 481.36,156.44 L 472.33,152.55 L 469.33,153.94 L 467.01,153.3 L 465.82,156.26 L 463.73,156.8 L 458.88,156.24 L 458.17,152.7 L 452.42,151.84 L 449.69,157.01 L 446.78,158.61 L 441.46,153.1 L 439.28,153.23 L 436.78,149.93 L 431.29,147.98 L 429.33,150.29 L 427.5,150.29 L 427.5,141 L 430.71,139.56 L 435.98,141.04 L 439.92,138.59 L 443.91,138.77 L 447.21,142.25 L 450.89,139.21 L 455.83,139.29 L 459.65,142.86 L 462.58,142.55 L 463.61,145.86 L 469.44,145.93 L 471.18,143.48 L 473.46,143.15 L 477.75,146.34 L 481.96,156.47 Z",
  BE: "M 427.5,150.29 L 429.33,150.29 L 431.29,147.98 L 436.78,149.93 L 439.28,153.23 L 441.46,153.1 L 446.78,158.61 L 449.69,157.01 L 452.42,151.84 L 458.17,152.7 L 458.88,156.24 L 463.73,156.8 L 465.82,156.26 L 467.01,153.3 L 469.33,153.94 L 472.33,152.55 L 481.36,156.44 L 481.96,156.47 L 484.33,156.71 L 484.71,163.78 L 487.75,163.67 L 489.58,165.9 L 495.52,167.3 L 498.91,165.96 L 501.72,167.08 L 504.79,166.47 L 507.78,171.02 L 511.32,170.82 L 513.39,173.92 L 516.14,173.88 L 516.84,177.62 L 519.85,179.01 L 522.15,178.05 L 523.28,180.11 L 521.61,183.45 L 518.68,185.3 L 520.31,187.51 L 518.91,189.83 L 514.9,190.84 L 514.28,193.9 L 508.92,195.35 L 507.76,198.51 L 510.2,200.78 L 511.31,205.92 L 510.15,208.08 L 504.76,210.05 L 502.86,208.51 L 498.08,210.13 L 496.5,212.94 L 492.93,213.66 L 493.74,220.34 L 492.5,223.3 L 490.25,223.3 L 490.37,226.24 L 492.61,228.39 L 493.1,233.71 L 490.95,235.07 L 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 L 450.81,194.26 L 449.92,184.25 L 453.63,179.02 L 457.57,177.02 L 460.22,173.3 L 459.96,169.64 L 464.98,163.95 L 465.9,159.2 L 463.73,156.8 L 465.82,156.26 L 467.01,153.3 L 469.33,153.94 L 472.33,152.55 L 481.36,156.44 L 481.96,156.47 L 474,151 L 468,151 L 465,145 L 452,142 L 445,146 L 435,146 L 427.5,150.29 Z",
  CH: "M 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 472.5,190 L 470,186 L 465,184 L 456,184 L 452,180 L 445,180 L 443,176 L 440,175.5 L 438,169 L 430,168 L 425,170 L 424.15,209.3 L 427.76,209.34 L 429.92,212.68 L 434.99,212.25 L 439.16,214.71 L 446.27,213.19 L 449.92,206.92 Z",
  AT: "M 502.86,208.51 L 498.08,210.13 L 496.5,212.94 L 492.93,213.66 L 493.74,220.34 L 492.5,223.3 L 490.25,223.3 L 490.37,226.24 L 492.61,228.39 L 493.1,233.71 L 490.95,235.07 L 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 476.61,196.84 L 478.33,195.51 L 478.66,191.89 L 484.3,189.16 L 489.57,182.9 L 494.84,177.93 L 498.58,177.28 L 501.27,173.14 L 504.54,172.78 L 505.01,169.45 L 507.78,171.02 L 511.32,170.82 L 513.39,173.92 L 516.14,173.88 L 516.84,177.62 L 519.85,179.01 L 522.15,178.05 L 523.28,180.11 L 521.61,183.45 L 518.68,185.3 L 520.31,187.51 L 518.91,189.83 L 514.9,190.84 L 514.28,193.9 L 508.92,195.35 L 507.76,198.51 L 510.2,200.78 L 511.31,205.92 L 510.15,208.08 L 504.76,210.05 L 502.86,208.51 Z",
  SE: "M 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 507.78,171.02 L 504.79,166.47 L 501.72,167.08 L 498.91,165.96 L 495.52,167.3 L 489.58,165.9 L 487.75,163.67 L 484.71,163.78 L 484.33,156.71 L 481.36,156.44 L 472.33,152.55 L 469.33,153.94 L 467.01,153.3 L 465.82,156.26 L 463.73,156.8 L 458.88,156.24 L 458.17,152.7 L 452.42,151.84 L 449.69,157.01 L 446.78,158.61 L 441.46,153.1 L 439.28,153.23 L 436.78,149.93 L 431.29,147.98 L 429.33,150.29 L 424.66,150.06 L 422.46,147.52 L 419.9,149.8 L 410.99,149.91 L 410.5,141.51 L 401.64,139.88 L 401.5,134.22 L 396.37,134.22 L 391.5,139 L 383.36,139 L 394.33,130.79 L 397.6,130.79 L 400.16,128.03 L 398.18,126.02 L 400.17,123.27 L 399.35,115.95 L 404.65,116.03 L 412.38,113.76 L 414.6,100.08 L 414.68,93.12 L 417.93,91.5 L 419.01,86.69 L 425.66,87.6 L 428.32,89.38 L 436.27,87.97 L 439.5,91.23 L 441,83.46 L 446.03,79.8 L 454.92,81.15 L 459.37,79.91 L 461.35,75.41 L 460.17,70.91 L 461.3,63.36 L 459.17,57.93 L 452.42,52.67 L 449.36,54.9 L 444.92,54.9 L 444.92,60.09 L 441.21,61.96 L 436.57,57.41 L 433.93,52.21 L 434.57,47.66 L 429.46,43.58 L 425.95,43.57 L 424.26,41.38 L 419.92,43.75 L 418.87,51.84 L 413.92,51.84 L 416.51,55.11 L 417.17,59.6 L 419.42,61.19 L 419.42,64.84 L 422.86,67.72 L 424.2,73.88 L 423.34,81.21 L 419.42,84.41 L 413.92,84.75 L 413.92,89.78 L 409.54,88.18 L 407.99,81.81 L 405.28,79.08 L 400.5,80.01 L 399.9,77.26 L 394.6,77.63 L 393.31,73.86 L 387.58,73.86 L 383.12,78.61 L 378.75,80.58 L 373.09,80.25 L 370.71,77.58 L 368.89,69.78 L 368.55,59.21 L 370.34,56.46 L 369.46,51.46 L 366.92,48.38 L 368.02,44.61 L 366.57,39.63 L 367.87,37.28 L 367.87,30.34 L 370.01,27.57 L 374.4,26.77 L 375.48,24.69 L 381.21,22.31 L 390.76,18.54 L 391.25,20.84 L 393.88,22.23 L 398.7,20.32 L 406.89,24.71 L 412.62,27.91 L 417.68,29.1 L 419.92,31.97 L 424.89,31.97 L 430.95,29.93 L 435.24,31.67 L 441.2,31.67 L 445.52,35.13 L 453.14,35.13 L 455.71,31.67 L 459.3,31.67 L 465.59,25.51 L 470.99,21.51 L 478.33,18.75 L 481.33,15.18 L 485.71,15.52 L 487.91,13.27 L 494.19,13.74 L 498.31,15.99 L 503.25,15.65 L 507.99,18.75 L 514.49,20.33 L 515.14,25.51 L 519.21,23.94 L 526.05,24.61 L 527.73,20.84 L 537.59,14.52 L 539.66,9.82 L 544.5,9.48 L 546.38,6.04 L 552.34,5.97 L 558.14,8.33 L 561.13,6.04 L 561.14,85.21 L 559.56,86.79 L 554.83,87.26 L 550.82,90.42 L 547.81,90.95 L 541.28,97.23 L 536.39,98.26 L 534.34,96.66 L 529.85,98.11 L 528.94,101.33 L 521.39,104.83 L 514.84,103.13 L 510.59,106.04 L 508.5,104.51 L 506.02,105.94 L 502.98,114.8 L 497.52,119.52 L 493.92,119.06 L 493.48,124.17 L 490.43,123.16 L 487.22,123.41 L 485.92,127.66 L 482.12,125.66 L 480.5,127.23 L 477.78,125.2 L 473.64,127.51 L 470.9,126 L 466.36,126.94 L 463.86,125.91 L 463.25,127.31 L 458.94,126.83 L 457.56,124.92 L 453.34,125.48 L 450.68,127.85 L 450.82,131.62 L 447.17,134.76 L 444.3,133.03 L 443.79,130.62 L 441.42,130.62 L 441.3,134.79 L 438.62,133.8 L 437.43,129.76 L 433.79,129.96 L 433.88,126.64 L 431.45,125.78 L 429.67,128.68 L 424.38,128.72 L 421.96,126.29 L 417.76,126.29 L 417.54,137.25 L 413.92,134.49 L 409.21,134.49 L 407.5,135.94 L 403.49,135.94 L 401.64,139.88 L 403.49,135.94 L 407.5,135.94 L 409.21,134.49 L 413.92,134.49 L 417.54,137.25 L 417.76,126.29 L 421.96,126.29 L 424.38,128.72 L 429.67,128.68 L 431.45,125.78 L 433.88,126.64 L 433.79,129.96 L 437.43,129.76 L 438.62,133.8 L 441.3,134.79 L 441.42,130.62 L 443.79,130.62 L 444.3,133.03 L 447.17,134.76 L 450.82,131.62 L 450.68,127.85 L 453.34,125.48 L 457.56,124.92 L 458.94,126.83 L 463.25,127.31 L 463.86,125.91 L 466.36,126.94 L 470.9,126 L 473.64,127.51 L 477.78,125.2 L 480.5,127.23 L 482.12,125.66 L 485.92,127.66 L 487.22,123.41 L 490.43,123.16 L 491.44,129.48 L 494.4,130.05 L 494.84,133.32 L 498.29,133.33 L 499.68,135.08 L 497.15,140.03 L 493.22,143.08 L 493.22,146.71 L 490.26,149.95 L 489.79,153.1 L 492.6,153.99 L 498.09,153.38 L 498.36,155.97 L 501.28,157.78 L 502.1,161.77 L 500.22,164.6 L 505.01,169.45 L 504.54,172.78 L 501.27,173.14 L 498.58,177.28 L 494.84,177.93 L 489.57,182.9 L 484.3,189.16 L 478.66,191.89 L 478.33,195.51 L 476.61,196.84 L 475.5,200.19 L 472.21,201.17 L 469.49,205.01 L 465.42,204.97 L 461.8,204.07 L 458.62,206.81 L 454.81,205.99 L 449.92,206.92 L 453.67,215.58 L 457.21,221.67 L 456.28,225.64 L 459.11,229.21 L 463.34,226.98 L 466.59,229.85 L 467.96,234.54 L 470.39,235.77 L 474.9,234.39 L 477.74,235.46 L 481.28,233.86 L 484.92,236.38 L 487.75,234.29 L 490.95,235.07 L 493.1,233.71 L 492.61,228.39 L 490.37,226.24 L 490.25,223.3 L 492.5,223.3 L 493.74,220.34 L 492.93,213.66 L 496.5,212.94 L 498.08,210.13 L 502.86,208.51 L 504.76,210.05 L 510.15,208.08 L 511.31,205.92 L 510.2,200.78 L 507.76,198.51 L 508.92,195.35 L 514.28,193.9 L 514.9,190.84 L 518.91,189.83 L 520.31,187.51 L 518.68,185.3 L 521.61,183.45 L 523.28,180.11 L 522.15,178.05 Z",
  NO: "M 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 507.78,171.02 L 504.79,166.47 L 501.72,167.08 L 498.91,165.96 L 495.52,167.3 L 489.58,165.9 L 487.75,163.67 L 484.71,163.78 L 484.33,156.71 L 481.36,156.44 L 472.33,152.55 L 469.33,153.94 L 467.01,153.3 L 465.82,156.26 L 463.73,156.8 L 458.88,156.24 L 458.17,152.7 L 452.42,151.84 L 449.69,157.01 L 446.78,158.61 L 441.46,153.1 L 439.28,153.23 L 436.78,149.93 L 431.29,147.98 L 429.33,150.29 L 424.66,150.06 L 422.46,147.52 L 419.9,149.8 L 410.99,149.91 L 410.5,141.51 L 401.64,139.88 L 401.5,134.22 L 396.37,134.22 L 391.5,139 L 383.36,139 L 394.33,130.79 L 397.6,130.79 L 400.16,128.03 L 398.18,126.02 L 400.17,123.27 L 399.35,115.95 L 404.65,116.03 L 412.38,113.76 L 414.6,100.08 L 414.68,93.12 L 417.93,91.5 L 419.01,86.69 L 425.66,87.6 L 428.32,89.38 L 436.27,87.97 L 439.5,91.23 L 441,83.46 L 446.03,79.8 L 454.92,81.15 L 459.37,79.91 L 461.35,75.41 L 460.17,70.91 L 461.3,63.36 L 459.17,57.93 L 452.42,52.67 L 449.36,54.9 L 444.92,54.9 L 444.92,60.09 L 441.21,61.96 L 436.57,57.41 L 433.93,52.21 L 434.57,47.66 L 429.46,43.58 L 425.95,43.57 L 424.26,41.38 L 419.92,43.75 L 418.87,51.84 L 413.92,51.84 L 416.51,55.11 L 417.17,59.6 L 419.42,61.19 L 419.42,64.84 L 422.86,67.72 L 424.2,73.88 L 423.34,81.21 L 419.42,84.41 L 413.92,84.75 L 413.92,89.78 L 409.54,88.18 L 407.99,81.81 L 405.28,79.08 L 400.5,80.01 L 399.9,77.26 L 394.6,77.63 L 393.31,73.86 L 387.58,73.86 L 383.12,78.61 L 378.75,80.58 L 373.09,80.25 L 370.71,77.58 L 368.89,69.78 L 368.55,59.21 L 370.34,56.46 L 369.46,51.46 L 366.92,48.38 L 368.02,44.61 L 366.57,39.63 L 367.87,37.28 L 367.87,30.34 L 370.01,27.57 L 374.4,26.77 L 375.48,24.69 L 381.21,22.31 L 390.76,18.54 L 391.25,20.84 L 393.88,22.23 L 398.7,20.32 L 406.89,24.71 L 412.62,27.91 L 417.68,29.1 L 419.92,31.97 L 424.89,31.97 L 430.95,29.93 L 435.24,31.67 L 441.2,31.67 L 445.52,35.13 L 453.14,35.13 L 455.71,31.67 L 459.3,31.67 L 465.59,25.51 L 470.99,21.51 L 478.33,18.75 L 481.33,15.18 L 485.71,15.52 L 487.91,13.27 L 494.19,13.74 L 498.31,15.99 L 503.25,15.65 L 507.99,18.75 L 514.49,20.33 L 515.14,25.51 L 519.21,23.94 L 526.05,24.61 L 527.73,20.84 L 537.59,14.52 L 539.66,9.82 L 544.5,9.48 L 546.38,6.04 L 552.34,5.97 L 558.14,8.33 L 561.13,6.04 L 561.14,85.21 L 559.56,86.79 L 554.83,87.26 L 550.82,90.42 L 547.81,90.95 L 541.28,97.23 L 536.39,98.26 L 534.34,96.66 L 529.85,98.11 L 528.94,101.33 L 521.39,104.83 L 514.84,103.13 L 510.59,106.04 L 508.5,104.51 L 506.02,105.94 L 502.98,114.8 L 497.52,119.52 L 493.92,119.06 L 493.48,124.17 L 490.43,123.16 L 522.15,178.05 Z",
  DK: "M 485.92,127.66 L 487.22,123.41 L 490.43,123.16 L 491.44,129.48 L 494.4,130.05 L 494.84,133.32 L 498.29,133.33 L 499.68,135.08 L 497.15,140.03 L 493.22,143.08 L 493.22,146.71 L 490.26,149.95 L 489.79,153.1 L 492.6,153.99 L 498.09,153.38 L 498.36,155.97 L 501.28,157.78 L 502.1,161.77 L 500.22,164.6 L 505.01,169.45 L 504.54,172.78 L 501.27,173.14 L 498.58,177.28 L 494.84,177.93 L 489.57,182.9 L 484.3,189.16 L 478.66,191.89 L 478.33,195.51 L 476.61,196.84 L 475.5,200.19 L 472.21,201.17 L 469.49,205.01 L 465.42,204.97 L 461.8,204.07 L 458.62,206.81 L 454.81,205.99 L 449.92,206.92 L 450.05,214.36 L 453.67,215.58 L 453.95,219.22 L 457.21,221.67 L 456.28,225.64 L 459.11,229.21 L 463.34,226.98 L 466.59,229.85 L 467.96,234.54 L 470.39,235.77 L 474.9,234.39 L 477.74,235.46 L 481.28,233.86 L 484.92,236.38 L 487.75,234.29 L 490.95,235.07 L 493.1,233.71 L 492.61,228.39 L 490.37,226.24 L 490.25,223.3 L 492.5,223.3 L 493.74,220.34 L 492.93,213.66 L 496.5,212.94 L 498.08,210.13 L 502.86,208.51 L 504.76,210.05 L 510.15,208.08 L 511.31,205.92 L 510.2,200.78 L 507.76,198.51 L 508.92,195.35 L 514.28,193.9 L 514.9,190.84 L 518.91,189.83 L 520.31,187.51 L 518.68,185.3 L 521.61,183.45 L 523.28,180.11 L 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 485.92,127.66 Z",
  FI: "M 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 507.78,171.02 L 504.79,166.47 L 501.72,167.08 L 498.91,165.96 L 495.52,167.3 L 489.58,165.9 L 487.75,163.67 L 484.71,163.78 L 484.33,156.71 L 481.36,156.44 L 472.33,152.55 L 469.33,153.94 L 467.01,153.3 L 465.82,156.26 L 463.73,156.8 L 458.88,156.24 L 458.17,152.7 L 452.42,151.84 L 449.69,157.01 L 446.78,158.61 L 441.46,153.1 L 439.28,153.23 L 436.78,149.93 L 431.29,147.98 L 429.33,150.29 L 424.66,150.06 L 422.46,147.52 L 419.9,149.8 L 410.99,149.91 L 410.5,141.51 L 401.64,139.88 L 401.5,134.22 L 396.37,134.22 L 391.5,139 L 383.36,139 L 394.33,130.79 L 397.6,130.79 L 400.16,128.03 L 398.18,126.02 L 400.17,123.27 L 399.35,115.95 L 404.65,116.03 L 412.38,113.76 L 414.6,100.08 L 414.68,93.12 L 417.93,91.5 L 419.01,86.69 L 425.66,87.6 L 428.32,89.38 L 436.27,87.97 L 439.5,91.23 L 441,83.46 L 446.03,79.8 L 454.92,81.15 L 459.37,79.91 L 461.35,75.41 L 460.17,70.91 L 461.3,63.36 L 459.17,57.93 L 452.42,52.67 L 449.36,54.9 L 444.92,54.9 L 444.92,60.09 L 441.21,61.96 L 436.57,57.41 L 433.93,52.21 L 434.57,47.66 L 429.46,43.58 L 425.95,43.57 L 424.26,41.38 L 419.92,43.75 L 418.87,51.84 L 413.92,51.84 L 416.51,55.11 L 417.17,59.6 L 419.42,61.19 L 419.42,64.84 L 422.86,67.72 L 424.2,73.88 L 423.34,81.21 L 419.42,84.41 L 413.92,84.75 L 413.92,89.78 L 409.54,88.18 L 407.99,81.81 L 405.28,79.08 L 400.5,80.01 L 399.9,77.26 L 394.6,77.63 L 393.31,73.86 L 387.58,73.86 L 383.12,78.61 L 378.75,80.58 L 373.09,80.25 L 370.71,77.58 L 368.89,69.78 L 368.55,59.21 L 370.34,56.46 L 369.46,51.46 L 366.92,48.38 L 368.02,44.61 L 366.57,39.63 L 367.87,37.28 L 367.87,30.34 L 370.01,27.57 L 374.4,26.77 L 375.48,24.69 L 381.21,22.31 L 390.76,18.54 L 391.25,20.84 L 393.88,22.23 L 398.7,20.32 L 406.89,24.71 L 412.62,27.91 L 417.68,29.1 L 419.92,31.97 L 424.89,31.97 L 430.95,29.93 L 435.24,31.67 L 441.2,31.67 L 445.52,35.13 L 453.14,35.13 L 455.71,31.67 L 459.3,31.67 L 465.59,25.51 L 470.99,21.51 L 478.33,18.75 L 481.33,15.18 L 485.71,15.52 L 487.91,13.27 L 494.19,13.74 L 498.31,15.99 L 503.25,15.65 L 507.99,18.75 L 514.49,20.33 L 515.14,25.51 L 519.21,23.94 L 526.05,24.61 L 527.73,20.84 L 537.59,14.52 L 539.66,9.82 L 544.5,9.48 L 546.38,6.04 L 552.34,5.97 L 558.14,8.33 L 561.13,6.04 L 561.14,85.21 L 559.56,86.79 L 554.83,87.26 L 550.82,90.42 L 547.81,90.95 L 541.28,97.23 L 536.39,98.26 L 534.34,96.66 L 529.85,98.11 L 528.94,101.33 L 521.39,104.83 L 514.84,103.13 L 510.59,106.04 L 508.5,104.51 L 506.02,105.94 L 502.98,114.8 L 497.52,119.52 L 493.92,119.06 L 493.48,124.17 L 490.43,123.16 L 487.22,123.41 L 485.92,127.66 L 522.15,178.05 Z",
  PL: "M 502.86,208.51 L 498.08,210.13 L 496.5,212.94 L 492.93,213.66 L 493.74,220.34 L 492.5,223.3 L 490.25,223.3 L 490.37,226.24 L 492.61,228.39 L 493.1,233.71 L 490.95,235.07 L 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 476.61,196.84 L 478.33,195.51 L 478.66,191.89 L 484.3,189.16 L 489.57,182.9 L 494.84,177.93 L 498.58,177.28 L 501.27,173.14 L 504.54,172.78 L 505.01,169.45 L 507.78,171.02 L 511.32,170.82 L 513.39,173.92 L 516.14,173.88 L 516.84,177.62 L 519.85,179.01 L 522.15,178.05 L 523.28,180.11 L 521.61,183.45 L 518.68,185.3 L 520.31,187.51 L 518.91,189.83 L 514.9,190.84 L 514.28,193.9 L 508.92,195.35 L 507.76,198.51 L 510.2,200.78 L 511.31,205.92 L 510.15,208.08 L 504.76,210.05 L 502.86,208.51 Z",
  CZ: "M 502.86,208.51 L 498.08,210.13 L 496.5,212.94 L 492.93,213.66 L 493.74,220.34 L 492.5,223.3 L 490.25,223.3 L 490.37,226.24 L 492.61,228.39 L 493.1,233.71 L 490.95,235.07 L 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 476.61,196.84 L 478.33,195.51 L 478.66,191.89 L 484.3,189.16 L 489.57,182.9 L 494.84,177.93 L 498.58,177.28 L 501.27,173.14 L 504.54,172.78 L 505.01,169.45 L 507.78,171.02 L 502.86,208.51 Z",
  HU: "M 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 450.05,214.36 L 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 487.75,234.29 Z",
  RO: "M 487.75,234.29 L 484.92,236.38 L 481.28,233.86 L 477.74,235.46 L 474.9,234.39 L 470.39,235.77 L 467.96,234.54 L 466.59,229.85 L 463.34,226.98 L 459.11,229.21 L 456.28,225.64 L 457.21,221.67 L 453.95,219.22 L 453.67,215.58 L 450.05,214.36 L 449.92,206.92 L 454.81,205.99 L 458.62,206.81 L 461.8,204.07 L 465.42,204.97 L 469.49,205.01 L 472.21,201.17 L 475.5,200.19 L 476.61,196.84 L 478.33,195.51 L 478.66,191.89 L 484.3,189.16 L 487.75,234.29 Z",
  GR: "M 490.25,223.3 L 492.5,223.3 L 493.74,220.34 L 492.93,213.66 L 496.5,212.94 L 498.08,210.13 L 502.86,208.51 L 504.76,210.05 L 510.15,208.08 L 511.31,205.92 L 510.2,200.78 L 507.76,198.51 L 508.92,195.35 L 514.28,193.9 L 514.9,190.84 L 518.91,189.83 L 520.31,187.51 L 518.68,185.3 L 521.61,183.45 L 523.28,180.11 L 522.15,178.05 L 519.85,179.01 L 516.84,177.62 L 516.14,173.88 L 513.39,173.92 L 511.32,170.82 L 507.78,171.02 L 504.79,166.47 L 501.72,167.08 L 498.91,165.96 L 495.52,167.3 L 489.58,165.9 L 490.25,223.3 Z",
  IE: "M 411.66,155.44 L 409.93,159.64 L 411.4,164.99 L 415.39,165.05 L 415.08,167.79 L 412.79,168.2 L 412.07,171.54 L 409.91,174.39 L 407.15,180.18 L 407.04,184.61 L 403.94,188.73 L 399.83,188.77 L 394.11,192.5 L 389.95,198.76 L 385.5,202 L 380.96,201.37 L 378.92,195.36 L 380.38,189.31 L 385.08,183.44 L 384.84,179.05 L 379.94,178 L 376.56,175.65 L 371.85,176.47 L 368.15,173.1 L 367.29,166.86 L 372.54,165.91 L 378.88,159.15 L 376.66,156.72 L 376.85,152.6 L 381.17,147.56 L 383.36,139 L 385.88,137.89 L 390.91,140.4 L 397.56,141.28 L 401.96,138.88 L 407.23,144.41 L 411.66,155.44 Z"
};

// Helper function to get color based on ROAS value
const getRoasColor = (roas: number) => {
  if (roas >= 5.0) return "bg-green-600";
  if (roas >= 4.0) return "bg-green-500";
  if (roas >= 3.5) return "bg-green-400";
  if (roas >= 3.0) return "bg-yellow-400";
  if (roas >= 2.5) return "bg-yellow-500";
  return "bg-red-500";
};

// Helper function to get fill color for map based on ROAS value
const getRoasMapColor = (roas: number) => {
  if (roas >= 5.0) return "#16a34a"; // green-600
  if (roas >= 4.0) return "#22c55e"; // green-500
  if (roas >= 3.5) return "#4ade80"; // green-400
  if (roas >= 3.0) return "#facc15"; // yellow-400
  if (roas >= 2.5) return "#eab308"; // yellow-500
  return "#ef4444"; // red-500
};

// Get text color for contrast
const getTextColor = (roas: number) => {
  return roas >= 3.0 ? "text-white" : "text-gray-800";
};

type EuropeRoasHeatmapProps = {
  loading: boolean;
  selectedChannel?: string | null;
};

export function EuropeRoasHeatmap({ loading, selectedChannel }: EuropeRoasHeatmapProps) {
  const [viewMode, setViewMode] = useState<"map" | "grid">("map");
  
  // Adjust ROAS values based on selected channel
  const adjustedData = useMemo(() => {
    return europeRegionsData.map(region => {
      let adjustFactor = 1;
      
      if (selectedChannel) {
        // Adjust ROAS based on channel selection (mock variation)
        switch (selectedChannel) {
          case "search":
            adjustFactor = region.id === "de" || region.id === "uk" ? 1.2 : 0.9;
            break;
          case "social":
            adjustFactor = region.id === "fr" || region.id === "es" ? 1.3 : 0.95;
            break;
          case "display":
            adjustFactor = region.id === "it" || region.id === "pt" ? 1.1 : 0.85;
            break;
          case "video":
            adjustFactor = region.id === "se" || region.id === "no" ? 1.25 : 0.9;
            break;
          case "email":
            adjustFactor = region.id === "nl" || region.id === "be" ? 1.15 : 0.95;
            break;
          default:
            adjustFactor = 1;
        }
      }
      
      return {
        ...region,
        roas: parseFloat((region.roas * adjustFactor).toFixed(1))
      };
    });
  }, [selectedChannel]);

  // Calculate average ROAS
  const averageRoas = useMemo(() => {
    const sum = adjustedData.reduce((acc, region) => acc + region.roas, 0);
    return (sum / adjustedData.length).toFixed(1);
  }, [adjustedData]);

  // Find best and worst regions
  const bestRegion = useMemo(() => {
    return adjustedData.reduce((best, current) => (current.roas > best.roas ? current : best), adjustedData[0]);
  }, [adjustedData]);

  const worstRegion = useMemo(() => {
    return adjustedData.reduce((worst, current) => (current.roas < worst.roas ? current : worst), adjustedData[0]);
  }, [adjustedData]);

  if (loading) {
    return <Skeleton className="w-full h-[400px] rounded-md" />;
  }

  return (
    <Card>
      <CardHeader>
        <div className="flex justify-between items-start">
          <div>
            <CardTitle className="flex items-center gap-2">
              Europe ROAS Performance Heatmap
              <Map className="h-5 w-5 text-muted-foreground" />
            </CardTitle>
            <CardDescription>
              {selectedChannel 
                ? `ROAS performance across European regions for ${selectedChannel} channel` 
                : "ROAS performance across European regions for all channels"}
            </CardDescription>
          </div>
          <div className="text-xs text-right">
            <div className="mb-1">Avg ROAS: <span className="font-semibold">{averageRoas}x</span></div>
            <div className="text-green-600 mb-1">Best: {bestRegion.name} ({bestRegion.roas}x)</div>
            <div className="text-red-500">Worst: {worstRegion.name} ({worstRegion.roas}x)</div>
          </div>
        </div>
      </CardHeader>
      <CardContent>
        <Tabs defaultValue="map" className="w-full" onValueChange={(value) => setViewMode(value as "map" | "grid")}>
          <TabsList className="mb-4">
            <TabsTrigger value="map" className="flex items-center gap-1">
              <Map className="h-4 w-4" /> Map View
            </TabsTrigger>
            <TabsTrigger value="grid" className="flex items-center gap-1">
              <Info className="h-4 w-4" /> Grid View
            </TabsTrigger>
          </TabsList>
          
          <TabsContent value="map" className="w-full">
            <div className="relative border rounded-lg overflow-hidden">
              <div className="bg-gray-50 w-full h-[450px] p-4">
                <svg 
                  viewBox="300 0 300 250" 
                  className="w-full h-full"
                >
                  {/* Europe Map */}
                  {adjustedData.map((region) => {
                    const pathData = europeMapPaths[region.code as keyof typeof europeMapPaths];
                    if (!pathData) return null;
                    
                    return (
                      <path
                        key={region.id}
                        d={pathData}
                        fill={getRoasMapColor(region.roas)}
                        stroke="#fff"
                        strokeWidth="0.5"
                        className="hover:opacity-80 transition-opacity cursor-pointer"
                      >
                        <title>{region.name}: ROAS {region.roas}x</title>
                      </path>
                    );
                  })}
                </svg>
              </div>
              
              {/* Legend */}
              <div className="absolute bottom-4 left-4 bg-white/90 p-2 rounded-md shadow-sm flex flex-wrap items-center gap-2 text-xs max-w-[300px]">
                <span className="font-medium">ROAS:</span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-red-500 mr-1 rounded-sm"></span>
                  &lt;2.5x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-yellow-500 mr-1 rounded-sm"></span>
                  2.5-3.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-yellow-400 mr-1 rounded-sm"></span>
                  3.0-3.5x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-400 mr-1 rounded-sm"></span>
                  3.5-4.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-500 mr-1 rounded-sm"></span>
                  4.0-5.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-600 mr-1 rounded-sm"></span>
                  5.0x+
                </span>
              </div>
            </div>
          </TabsContent>
          
          <TabsContent value="grid" className="w-full">
            <div className="relative">
              {/* Heat map grid */}
              <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2">
                {adjustedData.map((region) => (
                  <div 
                    key={region.id} 
                    className={`${getRoasColor(region.roas)} ${getTextColor(region.roas)} p-3 rounded-md transition-colors`}
                  >
                    <div className="font-medium">{region.name}</div>
                    <div className="text-sm opacity-90">ROAS: {region.roas}x</div>
                  </div>
                ))}
              </div>
              
              {/* Legend */}
              <div className="mt-6 flex flex-wrap items-center gap-2 text-xs">
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-red-500 mr-1 rounded-sm"></span>
                  &lt;2.5x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-yellow-500 mr-1 rounded-sm"></span>
                  2.5-3.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-yellow-400 mr-1 rounded-sm"></span>
                  3.0-3.5x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-400 mr-1 rounded-sm"></span>
                  3.5-4.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-500 mr-1 rounded-sm"></span>
                  4.0-5.0x
                </span>
                <span className="flex items-center">
                  <span className="inline-block w-3 h-3 bg-green-600 mr-1 rounded-sm"></span>
                  5.0x+
                </span>
              </div>
            </div>
          </TabsContent>
        </Tabs>
        
        <div className="mt-2 text-xs text-muted-foreground flex items-center">
          <Info className="h-3 w-3 mr-1" />
          {selectedChannel 
            ? "Regional ROAS varies by channel. Try selecting different channels to see the impact."
            : "Select a specific channel to see regional performance differences."}
        </div>
      </CardContent>
    </Card>
  );
}
